<!DOCTYPE html>
<style>
    html {
        height: 100vh;
    }
    body {
        min-height: 100vh;
        display: grid;
        grid-template-rows: 1fr auto;
    }
    .footer {
        grid-row-start: 2;
        grid-row-end: 3;
    }
</style>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>Cyber Ninja</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" property="og:description" content="Process of scanning a network or system to identify any existing security vulnerabilities">
  <meta name="image" property="og:image" content="/">
  <meta name="author" content="Abdullah Khabir">
  <meta name="generator" content="Hugo 0.110.0">

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/css/uikit.min.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="/css/style.min.css" integrity="" media="screen">
  
  <link rel="stylesheet" href="/css/syntax.min.css" integrity="" media="screen">

  <script src="https://cdn.jsdelivr.net/npm/mailgo@0.9.14/dist/mailgo.min.js" defer></script>

  <!--Favicon-->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

</head>
<body class="pentesting">
    <div class="wrapper"><div uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; bottom: #transparent-sticky-navbar">
    <nav class="uk-navbar-container uk-margin" uk-navbar="mode: click;" style="padding-right: 3rem">
        <div class="uk-navbar-right">
            <ul class="uk-navbar-nav uk-visible@s">
                
                <li><a style="font-size: 25px; text-transform: none" href="/"> Home
                        </a></li>

                
                
                
                
                
                
                
                
                
                <li><a style="font-size: 25px; text-transform: none" href="/about">About</a></li>
                
                
                
                
                
                
                
                
                
                <li class="uk-active"><a style="font-size: 25px; text-transform:none"
                        href="/pentesting">Pentesting</a></li>
                
                
                
                
                
                
                
                
                
                <li><a style="font-size: 25px; text-transform: none" href="/contact">Contact</a></li>
                
                
            </ul>

            <a class="uk-navbar-toggle uk-hidden@s" uk-toggle="target: #sidenav" uk-navbar-toggle-icon href="#"></a>

        </div>
    </nav>
</div>

<div id="sidenav" uk-offcanvas="overlay: true">
    <div class="uk-offcanvas-bar uk-flex uk-flex-column">

        <ul class="uk-nav uk-nav-primary uk-nav-center uk-margin-auto-vertical">
            
            <li><a style="font-size: 25px" href="https://abdullah.solutions"> Home </a></li>

            
            
            
            
            
            
            
            
            
            <li><a style="font-size: 25px" href="/about">About</a></li>
            
            
            
            
            
            
            
            
            
            <li class="uk-active"><a style="font-size: 25px" href="/pentesting">Pentesting</a></li>
            
            
            
            
            
            
            
            
            
            <li><a style="font-size: 25px" href="/contact">Contact</a></li>
            
            
        </ul>

    </div>
</div>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-147400444-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



<style>
  p {
    margin: 0
  }

  .people-wrap {
    display: inline-flex;
    margin-top: 10px;
  }

  .people-image {
    display: block;
    border-radius: 50%;
     
  }

  .people {
    margin-left: 20px;
    margin-right: 20px;
  }

  .name {
    margin: auto;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: #000;
    font-family: Roboto, sans-serif;
    line-height: 1.2;
    margin-top: 2rem;
  }

  .content img {
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    display: block;
    margin-left: auto;
    margin-right: auto;
    margin-bottom:30px;
  }

  p { margin-bottom: 1em; }

  body p:last-child { margin-bottom: 0em; }

  img.skills{
    height: 80px;
  }

  @media only screen and (min-width: 960px) {
    .content img{max-width:60vw; max-height:60vh}

  .content img{
      max-width:60vw;
      max-height:60vh
  }
  }
  .content{
      width: 90vw;
      max-width: 1200px
  }

  table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
  }

  td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
  }

</style>


<section>
  <div class="uk-container uk-margin-large-bottom uk-margin-medium-top">
    <h1 class="uk-text-center uk-heading-medium">Vulnerability Scanning</h1>
    <p class="uk-text-center uk-text-lead">Process of scanning a network or system to identify any existing security vulnerabilities</p>
    <p class="uk-text-center">Published on Mar 12, 2023</p>
    <p class="uk-text-center">Reading time: 7 minutes.</p>
    

    <hr class="full-width">
    

    <div class="content">
      <h4 id="how-vulnerability-scanners-work">How vulnerability scanners work?</h4>
<ul>
<li>Detect if target is up and running.</li>
<li>Conduct a full or partial port scan.</li>
<li>Identify running OS using common fingerprinting techniques.</li>
<li>Identify running services with common techniques such as banner grabbing,
service behavior identification or file discovery.</li>
<li>Execute a signature-matching process to discover vulnerabilities.</li>
</ul>
<blockquote>
<p>⚠️
Some vulnerability scanners can be configured to exploit a vulnerability
upon detection. This might crash the service so please check scanners options
carefully.</p>
</blockquote>
<p>Automated scanners can generate quite a few false positives and by contrast,
false negatives in which a vulnerability is overlooked because of a signature
mismatch. False positives and negatives can also occur becuase of backporting in
which a package maintainer roll back software security patches to older
versions. Backporting may result in the scanner flagging software as a
vulnerable version when the vulnerability has actually been repaired.
Because of this we should carefully inspect and manually review vulnerability
scan results whenever possible. By updating signature database before every
engagement, we ensure that our scanner has the best chance of discovering the
latest vulnerabilities.
This signature-matching process is quite efficient and is much faster than a
fully manual review, making automated vulnerability scanners an excellent choice
as a first-pass during an assessment and a perfect companion to a manual review.</p>
<h4 id="nessus-vulnerability-scanner">Nessus Vulnerability Scanner</h4>
<p><code>Nessus</code> is a popular vulnerability scanner. Previously it was open source but
now source is closed. You still can use it for education. It has a lot of
plugins.</p>
<h5 id="installing">Installing</h5>
<p>Go to <a href="https://www.tenable.com/products/nessus/nessus-essentials" target="_blank" >Downloads</a>

,
register for free education account and download it for your kali vm.
You will get an activation code on registered mail address.
Install it and enter activation code.</p>
<h5 id="installing-in-cloud">Installing in Cloud</h5>
<p>If you&rsquo;re practicing on cloud like <code>HackTheBox</code> etc, you can spin up an <code>AWS  EC2</code> and install <code>Nessus</code> there as well.
<a href="https://aws.amazon.com/marketplace/pp/prodview-fznsw3f7mq7to" target="_blank" >Here</a>

 is a
prebuilt kali image which is also <code>Free Tier eligible</code>.
This way you can use <code>HackTheBox</code> openvpn to connect kali vm to scan the
vulnerabilities in Playground.</p>
<h5 id="running-nessus">Running Nessus</h5>
<p>Once installed, start <code>Nessus</code> with:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl start nessusd.service
</span></span></code></pre></div><p>It will be running on your machine&rsquo;s <code>8834</code> port. If you installed in cloud, you
might have to add a rule for this <code>port</code>.
Just go to <code>https://kali_vm_ip:8834</code> and enter activation code you received from
<code>Tenable</code> and it will start downloading/compiling some plugins. After plugins
are installed, <code>Nessus</code> is ready to be used.</p>
<h5 id="first-scan">First Scan</h5>
<p>There are many types of scanning <code>Nessus</code> supports. I&rsquo;ll describe <code>Authenticated  Patch Audit</code> here.
In this scan type, scanner logs into the host and checks for vulnerable
software&hellip;</p>
<p>Go to <code>New Scan</code>. Choose <code>Authenticated Patch Audit</code>.
Add the name for scan, add the target.
Go to <code>Credentials</code> tab and select <code>SSH</code>.
Username should be root.
Now go to target host, and create an <code>SSH key</code>. You can choose <code>password  authentication</code> but that&rsquo;s not recommended.
Copy the public key to authorized_keys.</p>
<p><img src="https://user-images.githubusercontent.com/42554663/224534347-26e62e8a-502b-4b39-add4-d295cde7f165.gif" alt="authenticated_scan"></p>
<p>Once done, come back to <code>Nessus</code> and paste your <code>private key</code> (/root/.ssh/id_rsa).</p>
<p>Save and launch the scan. Once finished, you will see the results.</p>
<h5 id="advanced-scan">Advanced Scan</h5>
<p>We can have a basic network scan but that will take some time to complete as we
can&rsquo;t modify settings there that which plugins it is going to use. An advanced
scan allows fine-tuning of the plugins included in scan.
The Advanced Network Scan allows for a lot more customization to tailor fit a policy against a host or range of hosts. It offers a set of <code>Advanced defaults</code> which are hidden or unavailable to other templates and allows us to select individual plugins.</p>
<h4 id="scanning-with-nmap">Scanning with Nmap</h4>
<p>We can also use <code>NSE</code> nmap scripting engine to perform automated vulnerability
scans.</p>
<p>You can use <code>-sC</code> to run most common scripts against a target and <code>--script</code> to
choose your own scripts to execute by providing categories, filenames of
scripts, or name of directories full of scripts. On kali, scripts are located at
<code>/usr/share/nmap/scripts</code>. This directory also contains a file <code>script.db</code> which
categorizes each script in the directory.</p>
<p>Script scanning is also included as part of aggressive scan <code>-A</code> option.</p>
<p>You can pass arguments to scripts via <code>--script-args</code> and <code>--script-args-file</code>
options.</p>
<p>Script scanning is normally done in combination with a port scan, because
scripts mayb be run or not depending on the port states found by the scan. With
the <code>-sn</code> option, it&rsquo;s possible to run a script scan without a port scan, only
host discovery. In this case only the host scripts will be eligible to run. To
run a script scan with neither a host discovery nor a port scan, use <code>-Pn -sn</code>
options together with <code>-sC</code> or <code>--script</code>. Every host will be assumed up and
still only host scripts will be run. This technique is useful for scripts like
<code>whois-ip</code> that only use the remote system&rsquo;s address and don&rsquo;t require it to be
up.</p>
<h5 id="scripts-categories">Scripts categories</h5>
<ul>
<li>
<p><strong>auth</strong></p>
<p>Deal with authentication credentials or bypassing them on the target system.</p>
</li>
<li>
<p><strong>broadcast</strong></p>
</li>
</ul>
<p>They do discovery of hosts not listed on the command line by broadcasting on
the local network. Use the <code>newtargets</code> script argument to allow these
scripts to automatically add the hosts they discover to the Nmap scanning
queue.</p>
<ul>
<li>
<p><strong>brute</strong></p>
<p>These scripts use brute force attacks to guess authentication credentials of a remote server.</p>
</li>
<li>
<p><strong>default</strong></p>
<p>These scripts are the default set and are run when using the <code>-sC</code> or <code>-A</code>
options rather than listing scripts with <code>--script</code>. This category can also
be specified explicitly like any other using <code>--script=default</code>.</p>
</li>
<li>
<p><strong>discovery</strong></p>
<p>These scripts try to actively discover more about the network by querying public registries, SNMP-enabled devices, directory services, and the like. Examples include <em>html-title</em> (obtains the title of the root path of web sites), <em>smb-enum-shares</em> (enumerates Windows shares), and <em>snmp-sysdescr</em> (extracts system details via SNMP).</p>
</li>
<li>
<p><strong>dos</strong></p>
<p>Scripts in this category may cause a denial of service. Sometimes this is done to test vulnerability to a denial of service method, but more commonly it is an undesired by necessary side effect of testing for a traditional vulnerability. These tests sometimes crash vulnerable services.</p>
</li>
<li>
<p><strong>exploit</strong></p>
<p>These scripts aim to actively exploit some vulnerability. Examples include
<em>jdwp-exec</em> and <em>http-shellshock</em>.</p>
</li>
<li>
<p><strong>external</strong></p>
<p>Scripts in this category may send data to a third-party database or other network resource.</p>
</li>
<li>
<p><strong>fuzzer</strong></p>
<p>This category contains scripts which are designed to send server software unexpected or randomized fields in each packet. While this technique can useful for finding undiscovered bugs and vulnerabilities in software, it is both a slow process and bandwidth intensive. An example of a script in this category is <em>dns-fuzz</em>, which bombards a DNS server with slightly flawed domain requests until either the server crashes or a user specified time limit elapses.</p>
</li>
<li>
<p><strong>intrusive</strong></p>
<p>These are scripts that cannot be classified in the <em>safe</em> category because the risks are too high that they will crash the target system, use up significant resources on the target host (such as bandwidth or CPU time), or otherwise be perceived as malicious by the target&rsquo;s system administrators. Examples are <em>http-open-proxy</em> (which attempts to use the target server as an HTTP proxy) and <em>snmp-brute</em> (which tries to guess a device&rsquo;s SNMP community string by sending common values such as <em>public</em>, <em>private</em>, and <em>cisco</em>). Unless a script is in the special <em>version</em> category, it should be categorized as either <em>safe</em> or <em>intrusive</em>.</p>
</li>
<li>
<p><strong>malware</strong></p>
<p>These scripts test whether the target platform is infected by malware or
backdoors. Examples include <em>smtp-strangeport</em>,
which watches for SMTP servers running on unusual port numbers, and
<em>auth-spoof</em>, which detects identd spoofing daemons which provide a fake answer before even receiving a query. Both of these behaviors are commonly associated with malware infections.</p>
</li>
<li>
<p><strong>safe</strong></p>
<p>Scripts which weren&rsquo;t designed to crash services, use large amounts of
network bandwidth or other resources, or exploit security holes.
These are less likely to offend remote administrators, though (as with all
other Nmap features) we cannot guarantee that they won&rsquo;t ever cause adverse
reactions. Most of these perform general network discovery. Examples are
<em>ssh-hostkey</em> (retrieves an SSH host key) and <em>html-title</em> (grabs the title
from a web page). Scripts in the <em>version</em> category are not categorized by
safety, but any other scripts which aren&rsquo;t in <em>safe</em> should be placed in
<em>intrusive</em>.</p>
</li>
<li>
<p><strong>version</strong></p>
<p>The scripts in this special category are an extension to the version detection feature and cannot be selected explicitly. They are selected to run only if version detection <code>-sV</code> was requested. Their output cannot be distinguished from version detection output and they do not produce service or host script results. Examples are skypev2-version, <em>pptp-version</em>, and <em>iax2-version</em>.</p>
</li>
<li>
<p><strong>vuln</strong></p>
<p>These scripts check for specific known vulnerabilities and generally only
report results if they are found. Examples include <em>realvnc-auth-bypass</em> and
<em>afp-path-vuln</em>.</p>
</li>
</ul>
<h5 id="examples">Examples</h5>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap --script <span style="color:#0c6">&#34;not intrusive&#34;</span>
</span></span></code></pre></div><p>Load every script except for those in the <em>intrusive</em> category.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap --script <span style="color:#0c6">&#34;default or safe&#34;</span>
</span></span></code></pre></div><p>Load all scripts in <em>default</em> and <em>safe</em> category or both.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap --script <span style="color:#0c6">&#34;default and safe&#34;</span>
</span></span></code></pre></div><p>Load those scripts that are in both the <em>default</em> and <em>safe</em> categories.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap --script <span style="color:#0c6">&#34;(default or safe or intrusive) and not http-*&#34;</span>
</span></span></code></pre></div><p>Load scripts in the <em>default</em>, <em>safe</em>, or <em>intrusive</em> categories, except for
those whose names start with <em>http-</em>.</p>




<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;

    var disqus_shortname = 'akpk';

    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();

</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </div>
  </div>
  </div>
</section>






    </div>
<footer class="footer">
  <div class="uk-container">

    <div class="uk-grid-small uk-child-width-1-4@m uk-text-center uk-flex-center uk-margin-medium-bottom" uk-grid>
         </div>


    <div class="footer-copyright uk-text-center" style="padding-bottom: 1rem">
      <img loading="lazy" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="height: 1.2em;
  width: 1.2em;" alt="Creative Commons">
      <img loading="lazy" src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="height: 1.2em;
  width: 1.2em;" alt="CC-BY">
      2023
      Abdullah Khabir
    </div>
  </div>
</footer>


<!-- JS Plugins -->

<script src="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit-icons.min.js"></script>

</body>
</html>
