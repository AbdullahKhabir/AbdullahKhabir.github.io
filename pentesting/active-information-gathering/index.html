<!DOCTYPE html>
<style>
    html {
        height: 100vh;
    }
    body {
        min-height: 100vh;
        display: grid;
        grid-template-rows: 1fr auto;
    }
    .footer {
        grid-row-start: 2;
        grid-row-end: 3;
    }
</style>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>Cyber Ninja</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" property="og:description" content="Collect information about a target">
  <meta name="image" property="og:image" content="/">
  <meta name="author" content="Abdullah Khabir">
  <meta name="generator" content="Hugo 0.110.0">

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/css/uikit.min.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="/css/style.min.css" integrity="" media="screen">
  
  <link rel="stylesheet" href="/css/syntax.min.css" integrity="" media="screen">

  <script src="https://cdn.jsdelivr.net/npm/mailgo@0.9.14/dist/mailgo.min.js" defer></script>

  <!--Favicon-->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

</head>
<body class="pentesting">
    <div class="wrapper"><div uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; bottom: #transparent-sticky-navbar">
    <nav class="uk-navbar-container uk-margin" uk-navbar="mode: click;" style="padding-right: 3rem">
        <div class="uk-navbar-right">
            <ul class="uk-navbar-nav uk-visible@s">
                
                <li><a style="font-size: 25px; text-transform: none" href="/"> Home
                        </a></li>

                
                
                
                
                
                
                
                
                
                <li><a style="font-size: 25px; text-transform: none" href="/about">About</a></li>
                
                
                
                
                
                
                
                
                
                <li class="uk-active"><a style="font-size: 25px; text-transform:none"
                        href="/pentesting">Pentesting</a></li>
                
                
                
                
                
                
                
                
                
                <li><a style="font-size: 25px; text-transform: none" href="/contact">Contact</a></li>
                
                
            </ul>

            <a class="uk-navbar-toggle uk-hidden@s" uk-toggle="target: #sidenav" uk-navbar-toggle-icon href="#"></a>

        </div>
    </nav>
</div>

<div id="sidenav" uk-offcanvas="overlay: true">
    <div class="uk-offcanvas-bar uk-flex uk-flex-column">

        <ul class="uk-nav uk-nav-primary uk-nav-center uk-margin-auto-vertical">
            
            <li><a style="font-size: 25px" href="https://abdullah.solutions"> Home </a></li>

            
            
            
            
            
            
            
            
            
            <li><a style="font-size: 25px" href="/about">About</a></li>
            
            
            
            
            
            
            
            
            
            <li class="uk-active"><a style="font-size: 25px" href="/pentesting">Pentesting</a></li>
            
            
            
            
            
            
            
            
            
            <li><a style="font-size: 25px" href="/contact">Contact</a></li>
            
            
        </ul>

    </div>
</div>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-147400444-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



<style>
  p {
    margin: 0
  }

  .people-wrap {
    display: inline-flex;
    margin-top: 10px;
  }

  .people-image {
    display: block;
    border-radius: 50%;
     
  }

  .people {
    margin-left: 20px;
    margin-right: 20px;
  }

  .name {
    margin: auto;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: #000;
    font-family: Roboto, sans-serif;
    line-height: 1.2;
    margin-top: 2rem;
  }

  .content img {
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    display: block;
    margin-left: auto;
    margin-right: auto;
    margin-bottom:30px;
  }

  p { margin-bottom: 1em; }

  body p:last-child { margin-bottom: 0em; }

  img.skills{
    height: 80px;
  }

  @media only screen and (min-width: 960px) {
    .content img{max-width:60vw; max-height:60vh}

  .content img{
      max-width:60vw;
      max-height:60vh
  }
  }
  .content{
      width: 90vw;
      max-width: 1200px
  }

  table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
  }

  td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
  }

</style>


<section>
  <div class="uk-container uk-margin-large-bottom uk-margin-medium-top">
    <h1 class="uk-text-center uk-heading-medium">Active Information Gathering</h1>
    <p class="uk-text-center uk-text-lead">Collect information about a target</p>
    <p class="uk-text-center">Published on Mar 09, 2023</p>
    <p class="uk-text-center">Reading time: 10 minutes.</p>
    

    <hr class="full-width">
    

    <div class="content">
      <p><strong>Active Information Gathering</strong> involves direct interaction with target services.</p>
<h3 id="dns-enumeration">DNS Enumeration</h3>
<p><strong>DNS</strong> is one of the most critical system on the internet and is distributed database responsible for translating<br>
user-friendly domain names into IP addresses.</p>
<h3 id="how-dns-works">How DNS works?</h3>
<p>Lets take a closer look at the process and servers involved in resolving a hostname like <em>abdullah.solutions</em>.</p>
<p>The process starts when a hostname is entered into a browser or other application. The browser passes the hostname to<br>
the operating system&rsquo;s DNS client and operating system then forwards the request to the external DNS server its<br>
configured to use.</p>
<p>The first server in the chain is known as the <strong><em>DNS recursor</em></strong> and is responsible for interacting with the DNS infrastructure and returning the results to the DNS client. The DNS recursor contacts one of the server in the DNS root zone. The root server then responds with the address of the server responsible for the zone containing the Top Level Domain (TLD), in this case the <em>.solutions</em> TLD.<br>
Once the DNS recursor receives the address of the TLD DNS server, it quiries it for the address of the authoritative<br>
nameserver for the <em>abdullah.solutions</em> domain. The authoritative nameserver is the final step in the DNS lookup process<br>
and contains the DNS records in a local database known as the zone file. It typically hosts two zones for each domain,<br>
the forward lookup zone that is used to find the IP address of a specific hostname and the reverse lookup zone (if<br>
configured by the administrator), which is used to find the hostname of a specific IP address. Once the DNS recursor<br>
provides the DNS client with the IP address for <em>abdullah.solutions</em>, the browser can contact the correct web server as<br>
its IP address and load the webpage.</p>
<p>To improve the performance and reliability of DNS, DNS caching is used to store local copies of DNS records at various<br>
stages of the lookup process. It is for this reason that some modern application, such as web browsers, keep a separate<br>
DNS cache. In addition, the local DNS client of the operating system also maintains its own DNS cache along with each of<br>
the DNS servers in the lookup process. Domain owners can also control how long a server or client caches a DNS record<br>
via the <em>Time To Live</em> (TTL) field of a DNS record.</p>
<h3 id="interacting-with-a-dns-server">Interacting with a DNS server</h3>
<p>most common types of DNS records:</p>
<ul>
<li>NS  &raquo;   name of authoritative servers hosting DNS records for a domain</li>
<li>A   &raquo; IP addresses of a hostname</li>
<li>MX  &raquo; mail exchange records</li>
<li>PTR &raquo; Pointer records, used for reverse lookup and are used to find the records associated with an IP address</li>
<li>CNAME   &raquo; canonical name records are used to create aliases for other host records</li>
<li>TXT     &raquo;  Text records can contain any arbitrary data and can be used for various purposes such as domain
ownership verification.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  host abdullah.solutions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  abdullah.solutions has address 185.199.108.153
</span></span></code></pre></div><p>We can run <code>host</code> on any output/hostname we found.</p>
<h4 id="brute-force-forward-lookups">Brute Force forward lookups</h4>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">for</span> subdomain in www ftp mail proxy router; <span style="color:#2c5dcd;font-weight:bold">do</span> host $subdomain.abdullah.solutions; <span style="color:#2c5dcd;font-weight:bold">done</span>
</span></span></code></pre></div><p><img src="https://user-images.githubusercontent.com/42554663/222625653-243ce910-fd57-4775-86b6-e769d2ae7100.png" alt="host command brute force"></p>
<h4 id="seclists">Seclists</h4>
<p><a href="https://github.com/danielmiessler/SecLists" target="_blank" >SecLists</a>

 prject has much more comprehensive lists for this purpose.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt install seclists
</span></span><span style="display:flex;"><span>find / -type d -name seclists
</span></span></code></pre></div><h4 id="brute-force-reverse-lookups">Brute Force reverse lookups</h4>
<p>Run brute force on IP addresses found in previous step.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">for</span> ip in <span style="color:#2c5dcd;font-weight:bold">$(</span>seq <span style="color:#5918bb;font-weight:bold">50</span> 100<span style="color:#2c5dcd;font-weight:bold">)</span>; <span style="color:#2c5dcd;font-weight:bold">do</span> host xx.xx.xx.$ip; <span style="color:#2c5dcd;font-weight:bold">done</span> | grep -v <span style="color:#0c6">&#34;not found&#34;</span>
</span></span></code></pre></div><h4 id="dns-zone-transfer">DNS Zone Transfer</h4>
<p>Copy data from the Master DNS zone to the Secondary DNS zones.</p>
<p>For new DNS zone, you need to do AXFR zone transfer.
For already configured DNS zones, to make changes to primary DNS zone, you need IXFR zone transfer.</p>
<p>If DNS server is misconfigured, allowing anybody to be able to perform zone transfer can be a huge risk. It can show to the person who is performing it, the whole zone file, there can be DNS records that are only for internal use.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  host -l &lt;domain_name&gt; &lt;DNS server address&gt;
</span></span></code></pre></div><p>Or we can use <code>dig</code> command as well.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  dig &lt;domain_name&gt; -t ns
</span></span><span style="display:flex;"><span>  dig axfr &lt;domain_name&gt; &lt;Name Server&gt;
</span></span></code></pre></div><h4 id="dns-enumeration-tools">DNS Enumeration Tools</h4>
<h5 id="dnsrecon">DNSRecon</h5>
<p><a href="https://github.com/darkoperator/dnsrecon" target="_blank" >DNSRecon</a>

 is Python script to automate DNS enumeration.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  dnsrecon -d &lt;domain_name&gt; -t axfr
</span></span></code></pre></div><h5 id="dnsenum">DNSenum</h5>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  dnsenum &lt;domain_name&gt;
</span></span></code></pre></div><p><img src="https://user-images.githubusercontent.com/42554663/223098041-e8a6c0f9-cbee-417d-bca9-ac57c33022b9.png" alt="dnsenum running against zonetransfer.me"></p>
<h4 id="port-scanning">Port Scanning</h4>
<blockquote>
<p>⚠️
<em><em>Some port scans can have bad effects on target systems or client network so be careful with that&hellip;</em></em></p>
</blockquote>
<h5 id="tcp-ports">TCP ports</h5>
<p>3 way handshake technique:</p>
<p>A client sends <code>TCP SYN</code> packet.</p>
<p>If port is opened, the server responds with <code>SYN-ACK</code>.</p>
<p>The client sends <code>ACK</code> packet thus completing the handshake.</p>
<p>If handshake completes, the port is open.</p>
<ul>
<li>Using <code>netcat</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc -nv -w <span style="color:#5918bb;font-weight:bold">1</span> -z  &lt;host&gt; 1-65536
</span></span></code></pre></div><p><code>-z</code> will send no data and <code>-w</code> is used for connection timeout.</p>
<ul>
<li>Using <code>nmap</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sT -p- &lt;host&gt;
</span></span></code></pre></div><p><code>nmap</code> <code>-sT</code> option scans for TCP ports, and <code>-p-</code> instructs to scan all the ports.</p>
<ul>
<li>Using <code>bash</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">for</span> p in <span style="color:#2c5dcd">{</span>1..65535<span style="color:#2c5dcd">}</span>;
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>    timeout <span style="color:#5918bb;font-weight:bold">1</span> bash -c <span style="color:#0c6">&#34;&lt;/dev/tcp/&lt;host&gt;/</span>$p<span style="color:#0c6"> &amp;&gt;/dev/null&#34;</span> <span style="color:#2c5dcd">&amp;&amp;</span> <span style="color:#5918bb;font-weight:bold">echo</span> <span style="color:#0c6">&#34;Port </span>$p<span style="color:#0c6"> is opened...&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">done</span>
</span></span></code></pre></div><h5 id="udp-ports">UDP Ports</h5>
<ul>
<li>Using <code>netcat</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc -nv -u -z -w <span style="color:#5918bb;font-weight:bold">1</span> &lt;host&gt; &lt;range of ports&gt;
</span></span></code></pre></div><p><code>-u</code> is used to scan <code>UDP</code> ports.</p>
<ul>
<li>Using <code>nmap</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sU -p- &lt;host&gt;
</span></span></code></pre></div><p><code>nmap</code> <code>-sU</code> option is used to scan <code>UDP</code> ports.</p>
<ul>
<li>Using <code>bash</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">for</span> p in <span style="color:#2c5dcd">{</span>1..65535<span style="color:#2c5dcd">}</span>;
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>    timeout <span style="color:#5918bb;font-weight:bold">1</span> bash -c <span style="color:#0c6">&#34;&lt;/dev/udp/&lt;host&gt;/</span>$p<span style="color:#0c6"> &amp;&gt;/dev/null&#34;</span> <span style="color:#2c5dcd">&amp;&amp;</span> <span style="color:#5918bb;font-weight:bold">echo</span> <span style="color:#0c6">&#34;Port </span>$p<span style="color:#0c6"> is opened...&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">done</span>
</span></span></code></pre></div><h4 id="port-scanning-techniques">Port Scanning Techniques</h4>
<h5 id="syn-scanstealthtcp-half-open">SYN Scan/Stealth/TCP Half Open</h5>
<p>It&rsquo;s <code>nmap</code> default scanning technique when no technique is specified and user running <code>nmap</code> has raw socket privilege. (nmap is started by <code>root user</code> or prefixed with <code>sudo</code>) It&rsquo;s faster and more efficient as fewer packets are sent and received. Information isn&rsquo;t passed to application layer.
It works this way:</p>
<ul>
<li>Scanner sends a <code>SYN</code> packet.</li>
<li>If port is opened, <code>SYN-ACK</code> would be received from target.</li>
<li>Scanner won&rsquo;t bother to send the final <code>ACK</code>.</li>
</ul>
<p><code>RST</code> response signifies that port is closed but host is alive. And no response signifies that the host has filtered port. And <code>ICMP</code> no response is considered same as filtered.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sS &lt;host&gt;
</span></span></code></pre></div><h5 id="tcp-connect">TCP Connect</h5>
<p>If user doesn&rsquo;t have raw socket privileges, this technique is used in <code>nmap</code>. Unlike stealth technique, full connection is established. It takes much longer to complete this scan.
Makes more noise on network as you have to send another packet per scan.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sT &lt;host&gt;
</span></span></code></pre></div><h5 id="udp-scanning">UDP Scanning</h5>
<p>Slower compared to <code>TCP</code> scans, require same amount of enforced security
practices implemented on <code>TCP</code> ports.
<code>Nmap</code> uses two different methods to determine if a port is open or closed. For
most ports, it will use <code>ICMP port unreachable</code> method by sending an empty
packet to given port. For common ports such as port 161, which is used by
<code>SNMP</code>, it will send a protocol specific <code>SNMP</code> packet in attempt to get a
response from an application bound to that port.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sU &lt;host&gt;
</span></span></code></pre></div><blockquote>
<p>💊 The <code>UDP</code> scan can also be used in conjuction with a <code>TCP-SYN</code> scan to
build a more complete picture of target.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sS -sU &lt;host&gt;
</span></span></code></pre></div><h5 id="network-sweeping">Network Sweeping</h5>
<p>Scan so many hosts available in large network.
With <code>nmap</code>, we can use <code>-sn</code> and <code>nmap</code> not only use <code>ICMP</code> echo request, but
also other techniques.
It would send <code>TCP-SYN</code> packet to port <code>443</code>.
<code>TCP-ACK</code> to port 80.
<code>ICMP</code> timestamp request to verify if host is available.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sn &lt;network&gt;
</span></span></code></pre></div><h5 id="os-fingerprinting">OS Fingerprinting</h5>
<p><code>nmap</code> has <code>-O</code> option to guess the target host OS.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -O &lt;host&gt;
</span></span></code></pre></div><h5 id="banner-grabbingservice-enumeration">Banner Grabbing/Service Enumeration</h5>
<p><code>nmap</code> can identify services running on some ports by inspecting service banners
<code>-sV</code> and by running various OS and service enumeration scripts <code>-A</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sV -sT -A &lt;host&gt;
</span></span></code></pre></div><h5 id="nmap-scripting-engine-nse">Nmap Scripting Engine (NSE)</h5>
<p><code>nmap</code> has user-created scripts which can be used to automate scannig tasks.
These scripts are located at <code>/usr/share/nmap/scripts</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap &lt;host&gt; --script<span style="color:#2c5dcd">=</span>&lt;script to run&gt;
</span></span></code></pre></div><p>Help for these scripts can be obtained by running:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap --script-help &lt;script-name&gt;
</span></span></code></pre></div><h4 id="masscan">Masscan</h4>
<p>Fastest ports scanner. Can scan the entire internet.
Requires <code>sudo</code> privileges.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo masscan -p <span style="color:#5918bb;font-weight:bold">80</span> &lt;target network&gt; --rate <span style="color:#5918bb;font-weight:bold">1000</span> -e &lt;interface&gt; --router-ip &lt;router_ip&gt;
</span></span></code></pre></div><h4 id="smb-enumeration">SMB Enumeration</h4>
<p>Server Message Block, SMB is an application layer protocol that allows for file, printer, device sharing and inter-process communication (IPC) between applications on a network through a client-server architecture. In other words, computers (SMB clients) on a network can connect to SMB servers to access shared files and directories or perform tasks like printing over the network.
It uses <code>TCP</code> port <code>445</code>.</p>
<h5 id="scanning-netbios-service">Scanning NetBIOS Service</h5>
<p>Listens on <code>TCP</code> port <code>139</code> as well as severl <code>UDP</code> ports.
<code>NetBIOS</code> and <code>SMB</code> are two separate protocols.
<code>NetBIOS</code> is an independent session layer protocol and service that allows
computers on local network to communicate with each other. Modern
implementations of <code>SMB</code> can work without <code>NetBIOS</code>, <code>NetBIOS over TCP</code> (NBT) is
required for backward compatibility and is often enabled together.</p>
<p>Scan both of these services:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -v -p 139,445 -oG smb.txt &lt;target_network&gt;
</span></span></code></pre></div><p>There is <code>nbtscan</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nbtscan -r &lt;target_network&gt;
</span></span></code></pre></div><p><code>NSE Scripts</code> can be used to enumerate <code>SMB services</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -v -p 139,445 --script<span style="color:#2c5dcd">=</span>smb-os-discovery &lt;host&gt;
</span></span><span style="display:flex;"><span>nmap -v -p 139,445 --script<span style="color:#2c5dcd">=</span>smb-vuln-ms08-067 --script-args<span style="color:#2c5dcd">=</span>unsafe<span style="color:#2c5dcd">=</span><span style="color:#5918bb;font-weight:bold">1</span> &lt;target&gt;
</span></span></code></pre></div><blockquote>
<p>⚠️
Passing <code>--script-args=unsafe=1</code> while scanning might crash a vulnerable system.</p>
</blockquote>
<h4 id="nfs-enumeration">NFS Enumeration</h4>
<p>Network File System (NFS) is distributed file system protocol. It allows a user
on client computer to access files over a computer network as if they were on
locally-mounted storage.</p>
<h5 id="scanning-nfs-shares">Scanning NFS Shares</h5>
<p>Both <code>Portmapper</code> and <code>RPCbind</code> run on <code>TCP</code> port 111.
<code>RPCbind</code> maps RPC services to the ports on which they listen. RPC processes
notify rpcbind when they start, registering the ports they are listening on and
the RPC program numbers they expect to serve.</p>
<p>The client system then contacts <code>RPCbind</code> on the server with a particular RPC
program number. The rpcbind service redirects the client to the proper port
number (often <code>TCP</code> port 2049) so it can communicate with the requested service.</p>
<p>Scan these ports with <code>nmap</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -v -p <span style="color:#5918bb;font-weight:bold">111</span> &lt;host&gt;
</span></span></code></pre></div><p>We can use <code>NSE scripts</code> like <code>rpcinfo</code> to find services that may have
registered with rpcbind.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sV -p <span style="color:#5918bb;font-weight:bold">111</span> --script<span style="color:#2c5dcd">=</span>rpcinfo &lt;target_network&gt;
</span></span></code></pre></div><p>We can run all <code>NFS</code> related scripts with wildcard to enumerate NFS services and
discover additional services:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>nmap -p 111 --script nfs* &lt;target_host&gt;
</span></span></code></pre></div><h4 id="smtp-enumeration">SMTP Enumeration</h4>
<p>We can gather information about a host or network from vulnerable mail servers.
<code>SMTP</code> supports interesting commands such as <code>VRFY</code> and <code>EXPN</code>.</p>
<p><code>VRFY</code> to verify an email address.
<code>EXPN</code> to check membership of a mailing list.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc -nv &lt;smtp_server&gt; <span style="color:#5918bb;font-weight:bold">25</span>
</span></span><span style="display:flex;"><span>VRFY root
</span></span><span style="display:flex;"><span>VRFY idontexist
</span></span></code></pre></div><p>Here is a Python script to automate such process.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#0080ff;font-style:italic">#!/usr/bin/python</span>
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">import</span> socket
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">if</span> <span style="color:#5918bb;font-weight:bold">len</span>(sys<span style="color:#2c5dcd">.</span>argv) <span style="color:#2c5dcd">!=</span> <span style="color:#5918bb;font-weight:bold">3</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#5918bb;font-weight:bold">print</span>(<span style="color:#0c6">&#34;Usage: verify_smtp_user.py &lt;smtp_server&gt; &lt;username&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>    sys<span style="color:#2c5dcd">.</span>exit(<span style="color:#5918bb;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span><span style="color:#0080ff;font-style:italic"># Create a Socket</span>
</span></span><span style="display:flex;"><span>s <span style="color:#2c5dcd">=</span> socket<span style="color:#2c5dcd">.</span>socket(socket<span style="color:#2c5dcd">.</span>AF_INET, socket<span style="color:#2c5dcd">.</span>SOCK_STREAM)
</span></span><span style="display:flex;"><span><span style="color:#0080ff;font-style:italic"># Connect to the Server</span>
</span></span><span style="display:flex;"><span>connect <span style="color:#2c5dcd">=</span> s<span style="color:#2c5dcd">.</span>connect((sys<span style="color:#2c5dcd">.</span>argv[<span style="color:#5918bb;font-weight:bold">1</span>], <span style="color:#5918bb;font-weight:bold">25</span>))
</span></span><span style="display:flex;"><span><span style="color:#0080ff;font-style:italic"># Receive the banner</span>
</span></span><span style="display:flex;"><span>banner <span style="color:#2c5dcd">=</span> s<span style="color:#2c5dcd">.</span>recv(<span style="color:#5918bb;font-weight:bold">1024</span>)
</span></span><span style="display:flex;"><span><span style="color:#5918bb;font-weight:bold">print</span>(banner)
</span></span><span style="display:flex;"><span><span style="color:#0080ff;font-style:italic"># VRFY a user</span>
</span></span><span style="display:flex;"><span>s<span style="color:#2c5dcd">.</span>send(<span style="color:#0c6">&#39;VRFY &#39;</span> <span style="color:#2c5dcd">+</span> sys<span style="color:#2c5dcd">.</span>argv[<span style="color:#5918bb;font-weight:bold">2</span>] <span style="color:#2c5dcd">+</span> <span style="color:#0c6">&#39;</span><span style="color:#c5060b;font-weight:bold">\r\n</span><span style="color:#0c6">&#39;</span>)
</span></span><span style="display:flex;"><span>result <span style="color:#2c5dcd">=</span> s<span style="color:#2c5dcd">.</span>recv(<span style="color:#5918bb;font-weight:bold">1024</span>)
</span></span><span style="display:flex;"><span><span style="color:#5918bb;font-weight:bold">print</span>(result)
</span></span><span style="display:flex;"><span><span style="color:#0080ff;font-style:italic"># Close the socket</span>
</span></span><span style="display:flex;"><span>s<span style="color:#2c5dcd">.</span>close()
</span></span></code></pre></div><p>Modify the script as per your needs.</p>
<h4 id="snmp-enumeration">SNMP Enumeration</h4>
<p>Simple Network Management Protocol is an application layer protocol used to
exchange management information between network devices.</p>
<p>Organizations use <code>SNMP</code> protocol to monitor and manage devices in a local area
network or wide are network.
It uses <code>UDP</code> port 161 and 162 for sending commands and messages.</p>
<h5 id="snmp-mib-tree">SNMP MIB Tree</h5>
<p>The SNMP Management Information Base (MIB) is a database containing information
usually related to network management. Its organized like a tree, where branches
represent different organizations or network functions. The leaves of tree
correspond to specific variable values that can then be accessed, and probed by
an external user.</p>
<p>The following MIB values correspond to specific Windows SNMP parameters and
contains much more than network-based information:</p>
<table>
<thead>
<tr>
<th>MIB Values</th>
<th>SNMP Params</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.3.6.1.2.1.25.1.6.0</td>
<td>System Processes</td>
</tr>
<tr>
<td>1.3.6.1.2.1.25.4.2.1.2</td>
<td>Running Programs</td>
</tr>
<tr>
<td>1.3.6.1.2.1.25.4.2.1.4</td>
<td>Processes Path</td>
</tr>
<tr>
<td>1.3.6.1.2.1.25.2.3.1.4</td>
<td>Storage Units</td>
</tr>
<tr>
<td>1.3.6.1.2.1.25.6.3.1.2</td>
<td>Software Name</td>
</tr>
<tr>
<td>1.3.6.1.4.1.77.1.2.25</td>
<td>User Accounts</td>
</tr>
<tr>
<td>1.3.6.1.2.1.6.13.1.3</td>
<td>TCP Local Ports</td>
</tr>
</tbody>
</table>
<h5 id="scanning-for-snmp">Scanning for SNMP</h5>
<p>Scan with nmap:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sU --open -p <span style="color:#5918bb;font-weight:bold">161</span> &lt;target_network&gt; -oG open_snmp.txt
</span></span></code></pre></div><p><a href="http://www.phreedom.org/software/onesixtyone/" target="_blank" >onesixtyone</a>

 can be used for
brute force attack against a list of IP addresses.
Build a list of community strings, one string per line, and list of IP addresses
you want to scan, alternatively you can use community strings from <code>Seclists</code>
package.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>my_community_strings<span style="color:#2c5dcd">=</span><span style="color:#0c6">&#34;public\nprivate\nmanager&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#5918bb;font-weight:bold">echo</span> -n $my_community_strings &gt; strings.txt
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">for</span> ip in <span style="color:#2c5dcd;font-weight:bold">$(</span>seq <span style="color:#5918bb;font-weight:bold">1</span> 254<span style="color:#2c5dcd;font-weight:bold">)</span>; <span style="color:#2c5dcd;font-weight:bold">do</span> <span style="color:#5918bb;font-weight:bold">echo</span> 10.11.1.$ip; <span style="color:#2c5dcd;font-weight:bold">done</span> &gt; my_target_ips.txt
</span></span><span style="display:flex;"><span>onesixtyone -c strings.txt -i my_target_ips.txt
</span></span></code></pre></div><p>Once you find SNMP services, you can start querying them for specific MIB data
that might be interesting.</p>
<h5 id="enumerating-the-entire-mib-tree">Enumerating the Entire MIB Tree</h5>
<p>Suppose you have a Windows SNMP port exposed with community string &ldquo;public&rdquo;.
You can use <code>snmpwalk</code> to enumerate the entire MIB tree:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>snmpwalk -c public -v1 -t <span style="color:#5918bb;font-weight:bold">10</span> &lt;target&gt;
</span></span></code></pre></div><p><code>-c</code> is used for community string, in this case, public, <code>-v</code> for SNMP version
number and <code>-t</code> to increase the timeout period to 10.
You can use the table above to enumerate users, open ports, installed software.</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>snmpwalk -c public -v1 &lt;target&gt; &lt;value_from_table&gt;
</span></span></code></pre></div>



<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;

    var disqus_shortname = 'akpk';

    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();

</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </div>
  </div>
  </div>
</section>






    </div>
<footer class="footer">
  <div class="uk-container">

    <div class="uk-grid-small uk-child-width-1-4@m uk-text-center uk-flex-center uk-margin-medium-bottom" uk-grid>
         </div>


    <div class="footer-copyright uk-text-center" style="padding-bottom: 1rem">
      <img loading="lazy" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="height: 1.2em;
  width: 1.2em;" alt="Creative Commons">
      <img loading="lazy" src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="height: 1.2em;
  width: 1.2em;" alt="CC-BY">
      2023
      Abdullah Khabir
    </div>
  </div>
</footer>


<!-- JS Plugins -->

<script src="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit-icons.min.js"></script>

</body>
</html>
